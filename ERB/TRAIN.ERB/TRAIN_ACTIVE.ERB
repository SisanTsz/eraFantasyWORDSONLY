@TRAIN_ACTIVE ;主动战斗
    #DIM LCOUNT
    #DIM CNUM
    #DIM TRAINNO
    #DIMS PRE
    #DIMS PRE_1
    #DIMS PRE_2
    STR:TRAINACTIVECODE1 = 1.1.2
    FOR LCOUNT, 1, 101
        PRE = TRAINACTIVECODE%TOSTR(LCOUNT)%
        IF STR:PRE != ""
            CALL TRAIN_ACTIVE_DECODE(STR:PRE)
        ENDIF
    NEXT

@TRAIN_ACTIVE_DECODE(ARGS) ;把指令列表解码
    #DIM WNUM
    #DIM LNUM
    #DIM TRAINER
    #DIM TRAINEE
    #DIM TRAINN
    #DIM WNO = 0
    #DIM LCOUNT
    #DIMS PRE 
    #DIMS PRE_1
    SPLIT ARGS, ".", LOCALS
    TRAINER = TOINT(LOCALS:0)
    TRAINEE = TOINT(LOCALS:2)
    TRAINN = TOINT(LOCALS:1)
    TRYCALLFORM COM_{TRAINN}(TRAINER,TRAINEE)
    TRYCALLFORM TRAIN_PUSH_KOJO_{TRAINER}_{TRAINN}a
    TRYCALLFORM TRAIN_PUSH_KOJO_{TRAINEE}_{TRAINN}b

    

@TRAIN_ACTIVE_CODE_PUSH(ARG:1, ARG:2, ARG:3) ;新增指令列表
    #DIM WNUM
    #DIM LNUM
    #DIM WNO = 0
    #DIM LCOUNT
    #DIMS PRE 
    #DIMS PRE_1
    #DIMS CODE
    #DIM INITIATED
    WNO = 0
    
    LNUM = 15
    IF ARG:1 != 0 && ARG:2 != 0 && ARG:3 != 0
        CODE = %TOSTR(ARG:1)%.%TOSTR(ARG:2)%.%TOSTR(ARG:3)%
        PRE = TRAINACTIVECODE%TOSTR(TRAIN_ACTIVE_CODE_LAST())%
        STR:PRE = %CODE%
    ENDIF
    ;进行列表刷新(消除空行)
    $LOOP_1
    INITIATED = 0
    FOR LCOUNT, 1, 100
        PRE = TRAINACTIVECODE%TOSTR(LCOUNT)%
        PRE_1 = TRAINACTIVECODE%TOSTR(LCOUNT+1)%
        IF STR:PRE == ""
            STR:RPE == STR:RPE_1
            INITIATED = 1
        ENDIF
    NEXT
    SIF INITIATED == 1
        GOTO LOOP_1

@TRAIN_ACTIVE_CODE_LAST
    #FUNCTIONS
    #DIM LCOUNT 
    #DIM NUM
    #DIMS PRE
    NUM = 0
    FOR LCOUNT, 100, 0, -1
        PRE = TRAINACTIVECODE%TOSTR(LCOUNT)%
        IF STR:PRE != ""
            NUM = LCOUNT
            BREAK
        ENDIF
    NEXT
    RETURNF NUM

@TRAIN_ACTIVE_STOP(ARG)
    #DIM LCOUNT
    #DIMS PRE
    #DIMS PRE_1
    FOR LCOUNT, 1, 101
        PRE = TRAINACTIVECODE%TOSTR(LCOUNT)%
        SPLIT STR:PRE , ".", LOCALS
        IF LOCALS:0 == ARG
            STR:PRE = ""
        ENDIF
        IF LOCALS:2 == ARG 
            STR:PRE = ""
        ENDIF
    NEXT
    CALL TRAIN_ACTIVE_CODE_PUSH
